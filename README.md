## サービス概要

**学生アルバイトに特化した勤怠管理システム**

現在、弊社では学生アルバイトの勤怠管理を手作業（スプレッドシート）で行っているため、週20時間制限チェック、掛け持ちバイトとの合計管理、承認フローなどで多大な工数とヒューマンエラーが発生している。

既存の勤怠システム（ラクロー）では対応できない学生特有の労働制約を自動管理し、手作業を削減して正確性と効率性を向上させるWebアプリケーションを開発する。

## このサービスへの思い・作りたい理由

### 現場の課題体験から生まれたアイデア

最近、部署でアルバイトメンバーの管理業務を担当するようになり、現在の運用の課題を日々実感しています：

**具体的な痛点**
- 毎月25日のシフト提出時に週20h制限を手計算でチェック
- 掛け持ちバイトの時間を別途収集して合計40h/週をExcelで計算
- 勤怠実績をスプレッドシートで個別確認・承認
- ラクローとの整合性チェックを目視で実施
- 交通費申請の承認ルート設定漏れの頻発

### 既存ソリューションの限界

市販の勤怠管理システムは法人向けが中心で、学生アルバイト特有の制約（週20h制限、掛け持ち管理）に対応していません。また、導入コストやサブスク費用も中小企業には負担が大きく、現実的ではありません。

### 将来への展望

まずは学生アルバイト管理の課題解決から始め、成功すれば業務委託者管理への拡張も視野に入れています。Rails・Vue.jsの学習も兼ねた実践的な開発として取り組みます。

## ユーザー層について

### 主要ユーザー

**1. 学生アルバイト**
- 週20時間以内の労働制限があり、複数アルバイトとの合計管理が必要
- シフト希望提出、勤怠登録、各種申請を効率的に行いたいニーズ

**2. 部署担当者（管理者）**
- アルバイトのシフト管理、勤怠承認、労働時間制限チェックを担当
- 手作業による確認作業の負荷軽減が急務

**3. 労務担当者（最終承認者）**
- 全社的な労務管理の観点から最終確認を実施
- 法的制約の遵守状況を効率的に監視したいニーズ

**4. システム管理者**
- ユーザの承認・権限設定、部署管理を担当
- 新規ユーザのシステム利用開始時の初期設定
- 部署横断でのシステム運用管理

### ターゲット選定理由

**既存システムのギャップ分析**
- 正社員：ラクローで勤怠管理が完結している
- 学生アルバイト：ラクローでは週20h制限や掛け持ち管理に対応できず、手作業が発生

**スケーラビリティ考慮**
現在は一部署のみの課題ですが、他部署でも学生アルバイト雇用が始まる可能性があります。部署横断で利用できるマルチテナント設計により、全社展開に備えます。

## サービスの利用イメージ

### 提供価値の概要

本システムにより、学生アルバイトの勤怠管理における手作業を大幅に削減し、法的制約の自動チェック、承認フローの効率化、ヒューマンエラーの防止を実現します。
※後述の現在の業務フローと改善後のフローで詳細な変化を記載。

### 現在の労働条件
学生アルバイトは以下のルールで勤務可能：
- 週20時間以内の勤務（他アルバイトとの合計は40時間/週以下）
- 勤務時間帯：9:00 - 18:00
- 6時間以上勤務の場合は1時間の休憩が必要（休憩時間は労働時間に含まず）

**勤務例**
- 例1：月5h, 水5h, 木5h, 金5h（休憩なし）→ 実労働20h　✓
- 例2：月6h, 水6h, 木6h, 金6h（各日1h休憩）→ 実労働20h　✓
- 例3：月8h, 水8h, 金8h（各日1h休憩）→ 実労働21h　✗

### Before：現在の業務フロー（課題）

| 業務 | アルバイト | 部署担当者 | 労務担当者 | 課題 |
|------|------------|------------|------------|------|
| **①シフト提出** | スプレッドシートに希望記入<br/>掛け持ちバイト情報を別途提出 | 週20h制限を手計算チェック<br/>掛け持ち含む40h/週を手計算 | 掛け持ち情報を転記<br/>制限チェックを再実施 | 手計算による工数増・ミスリスク |
| **②勤怠登録** | スプレッドシートに出退勤・休憩時間を記入 | 個別に目視確認してOK記載 | 特になし | 転記ミス・確認漏れのリスク |
| **③欠勤等** | スプレッドシート記入＋ラクロー登録 | スプレッドシート確認・承認 | 特になし | 二重入力による非効率 |
| **④月次締め** | ラクロー記入漏れ・PCログを手動確認 | PCログ確認 | スプレッドシートとラクローの整合性を目視チェック | 手作業によるチェック負荷 | 月の最終出社日
| **⑤交通費** | ジョブカンで申請・承認ルート手動設定 | 申請内容と勤怠の照合確認 | 特になし | 承認ルート設定漏れ頻発 | 月の最終出社日

### After：改善後の業務フロー

| 業務 | アルバイト | 部署担当者 | 労務担当者 | 改善効果 |
|------|------------|------------|------------|----------|
| **①シフト提出** | アプリで希望・掛け持ち情報を一元入力 | **自動チェック結果を確認**<br/>（システムが制限違反を検知） | **自動チェック結果を確認**<br/>（手作業チェック不要） | ✅ 手計算作業削減<br/>✅ ミス防止 |
| **②勤怠登録** | アプリで出退勤・休憩を入力 | アプリで一覧確認・一括承認 | 特になし | ✅ 転記ミス防止<br/>✅ 確認効率化 |
| **③欠勤等** | アプリで欠勤・遅刻・早退を登録<br/>（ラクローへは別途登録が必要） | アプリで確認・承認 | 特になし | ✅ 管理の一元化<br/>✅ 承認フロー明確化 |
| **④月次締め** | アプリでチェックリスト確認・完了報告 | チェックリスト確認・承認 | アプリとラクローの勤怠データを効率的に照合 | ✅ 目視確認作業削減<br/>✅ チェック漏れ防止 | 月の最終出社日
| **⑤交通費** | アプリからジョブカン遷移<br/>**承認ルート設定をリマインド表示** | アプリで申請状況一覧確認・承認 | 特になし | ✅ 設定漏れ防止<br/>✅ 確認作業効率化 | 月の最終出社日

## ユーザーの獲得について

### 段階的導入による運用移行

**Phase 1：試験運用・改善期間（2ヶ月間）**
- **対象**：部署内の学生アルバイト（現在5名）
- **運用方法**：既存のスプレッドシート運用と並行してアプリを試験利用
- **改善プロセス**：試験運用と並行して日々のフィードバックを基に機能改善・UI/UX調整を実施
- **承認フロー最適化**：部署担当者・労務担当者の実際の業務に合わせて承認プロセスを調整

**フィードバック収集体制**
- **学生アルバイト**：日々のヒアリングで改善点・使いにくさを継続収集
- **部署担当者**：開発者自身が実際の承認業務を通じて操作性・機能性を検証
- **労務担当者**：2週間に1度の定期ヒアリングで全体的な運用状況を確認

**Phase 2：本番リリース準備期間（Phase 1と並行実施）**
- **評価・判断**：試験運用1ヶ月目の結果を基に本格導入の可否を判断
- **稟議申請**：運用が安定していると判断できた段階で本番リリース向け稟議申請を開始
- **ドキュメント整備**：試験運用と並行して運用マニュアルを作成

**Phase 3：本格運用開始**
- **移行完了**：稟議承認後、本アプリケーションのみでの運用に完全移行
- **目標期間**：試験運用開始から最短2ヶ月後の本格稼働を目指す

## サービスの差別化ポイント・推しポイント
### 差別化ポイント

**1. ラクローで管理しきれない部分に特化**
- ラクローで管理しきれない学生アルバイト管理に特化
- 週20時間制限、掛け持ちバイト管理という固有の制約対応

**2. 現実的な移行戦略**
- 既存システムを完全置換するのではなく、補完する設計
- 段階的導入により、運用リスクを最小化

**3. 現場起点の設計思想**
- 実際の業務経験者が設計するため、現場の課題を解決
- スプレッドシート管理からの自然な移行を実現

### 推しポイント

**コストパフォーマンス**
- 社内ニーズに特化した機能開発により、無駄な機能を排除

**拡張性**
- 学生アルバイト管理で成功後、業務委託者管理への展開が容易
- 社内システムとして、将来的な機能追加・改修の自由度が高い

## 機能候補

### MVP（Minimum Viable Product）
**目標：基本的な勤怠管理業務を効率化**

#### 🔑 コア機能
**ユーザー管理・認証**
- Google Workspace SSO連携
- 部署・役職・権限管理（アルバイト/部署担当者/労務担当者/システム管理者）
- 新規ユーザ承認ワークフロー
- 管理者による部署・権限設定

**シフト管理**
- 月次シフト希望提出フォーム
- 掛け持ちバイト情報登録
- **自動制限チェック**（週20h/掛け持ち合計40h）
- 制限違反時のアラート表示

**勤怠管理**
- 日次出退勤・休憩時間登録
- 6時間以上勤務時の休憩時間自動計算

**申請・承認ワークフロー**
- 各種申請機能（欠勤・遅刻・早退申請）
- **並列二段階承認**（部署担当者・労務担当者が並行して承認可能）
- 部署承認・労務承認・最終承認状況の可視化
- 一方の承認完了後に他方の承認を待たないボトルネック回避設計

**システム管理機能**
- 管理者ダッシュボード（承認待ちユーザ、利用統計）
- ユーザ管理（新規ユーザ承認、権限設定、部署割り当て）
- 部署管理（部署作成・編集・削除、担当者設定）
- 新規ユーザ向け承認待ち画面（連絡先案内、手順説明）

#### 🔗 外部システム対応
- ラクロー連携（遷移リンク・チェックリスト提供）
- ジョブカン連携（遷移リンク・申請ガイド表示）

#### 🤖 バッチ処理・自動化（MVP必須）
- 日次勤怠サマリ作成（前日分の打刻データから勤怠サマリを自動生成）
- 週次労働時間制限チェック（週20h/40h制限違反の自動検知・警告）

### 本リリース
**目標：運用の完全自動化・最適化**

#### 📊 高度な分析・レポート機能
- 月次勤怠集計レポート
- 労働時間トレンド分析

### 実際に社内で使えるようになったら
ラクローやジョブカンとの外部API連携しアプリで集中管理したい
しかし、それぞれ法人アカウントで申請が必要なので今課題では対応しない

#### 🔔 プロアクティブな通知システム
- Slack連携による即時通知
- 締切日前のリマインダー

## 使用する技術スタック

### システムアーキテクチャ

**アプリケーション**
- Rails：メインアプリケーション（ビュー、ビジネスロジック、API）
- Vue.js：部分的組み込み
- PostgreSQL：メインデータベース
- Redis：セッション管理、ジョブキュー
- Docker：開発環境統一・デプロイ効率化

**認証・外部サービス**
- Google OAuth：ユーザー認証
- Slack API：通知送信（Background Jobs経由）
- Background Jobs（Sidekiq）：非同期処理（通知、バッチ処理等）

### 技術スタック選定理由

#### バックエンド：Ruby on Rails 7.1
- **学習目標との適合**：Rails・Vue.js習得が目的の一つ
- **開発効率**：CRUD中心の業務アプリに最適
- **生産性**：短期間でのMVP開発に有利

#### フロントエンド：Vue.js 3 + TypeScript（部分組み込み）
- **段階的導入**：Rails Viewの動的部分のみに適用
- **メンテナンス性**：TypeScriptによる型安全性

#### インフラ・ツール
| 分野 | 選定技術 | 選定理由 |
|------|----------|----------|
| **DB** | PostgreSQL 15 | Rails標準、JSON型サポート |
| **デプロイ** | Render | Heroku代替、コスパ良好 |
| **認証** | Google Workspace OAuth | 社内アカウントとの親和性 |
| **キャッシュ** | Redis | セッション管理、ジョブキュー |
| **開発環境** | Docker + Docker Compose | 環境統一、セットアップ簡略化 |
| **監視** | New Relic（検討中） | 本格運用時のパフォーマンス監視 |

### 開発支援ツール
- **認証・認可**: Devise + Pundit + omniauth-google-oauth2
- **ワークフロー管理**: AASM（承認状態の管理）
- **バックグラウンド処理**: Sidekiq（通知・バッチ処理）
- **テスト**: RSpec + Capybara（E2Eテスト含む）
- **Vue.js統合**: Vite Rails（アセット管理、HMR対応）

### セキュリティ・運用考慮
- **セキュリティ**: SSO認証、RBAC（Role-Based Access Control）
- **データ保護**: 個人情報の暗号化、アクセスログ管理
- **可用性**: DB定期バックアップ、ヘルスチェック機能

### バッチ処理・自動化
- **日次勤怠サマリ作成**: 毎日AM2:00に前日分の打刻データから勤怠サマリを自動生成
- **週次制限チェック**: 日次サマリ作成時に週20h/40h制限違反を自動検知・警告
- **リマインダー通知**: シフト提出期限、月末締め期限の事前通知を自動送信
- **データ整合性チェック**: 打刻漏れ、異常データの検出と通知

## 権限設計・ユーザ管理

### 権限レベル
| 権限 | 説明 | 主な機能 |
|------|------|----------|
| **アルバイト** | 一般学生ユーザ | シフト希望提出、勤怠登録、各種申請 |
| **部署担当者** | 部署内アルバイト管理 | 自部署アルバイトの承認・管理 |
| **労務担当者** | 全社労務管理 | 全部署の労務観点での承認・制約チェック |
| **システム管理者** | システム全体管理 | ユーザ承認、部署管理、システム設定 |

### ユーザ登録・承認フロー
1. **Google OAuth認証**: 会社のGoogleアカウントでログイン
2. **承認待ち状態**: 初回ログイン時は承認待ち画面を表示
3. **管理者承認**: システム管理者が部署・権限を設定して承認
4. **システム利用開始**: 承認後、設定された権限でシステム利用可能

### 部署管理
- **管理部署**: システム管理者が所属（情報システム部など）
- **労務部署**: 労務担当者が所属、部署担当者と労務担当者の兼任可能
- **一般部署**: 通常の事業部署、アルバイトと部署担当者が所属

### 初期設定
- 情報システム部にシステム管理者権限の初期ユーザを設定
- 管理者が他部署・ユーザを順次登録・承認する運用

### 画面遷移図
Figma: https://www.figma.com/design/xjqV0lyze9E7nNkKbOTeh6/Rakuko?node-id=0-1&t=cp8LNpW1SiGOXaP6-1

## 開発環境セットアップ・実行コマンド

### 環境構築

**Docker環境の起動**
```bash
# 全サービス起動（Rails + PostgreSQL + Redis）
docker-compose up -d

# データベースのセットアップ
docker-compose exec web bin/rails db:create db:migrate db:seed
```

### 開発サーバー

**Railsサーバー起動**
```bash
# Docker環境
docker-compose up -d web
# ローカル環境
bin/rails server
```

**フロントエンド開発サーバー（Vue.js）**
```bash
# Vite開発サーバー起動（HMR対応）
bin/vite dev
# または
npm run dev
```

**フルスタック開発**
```bash
# Rails + Vite を同時起動
foreman start -f Procfile.dev
```

### データベース操作

```bash
# マイグレーション実行
docker-compose exec web bin/rails db:migrate

# シードデータ投入
docker-compose exec web bin/rails db:seed

# データベースリセット
docker-compose exec web bin/rails db:reset

# Railsコンソール
docker-compose exec web bin/rails console
```

### コード品質チェック

**リント・フォーマット**
```bash
# フロントエンド（Biome）
docker-compose exec web npm run lint          # チェックのみ
docker-compose exec web npm run lint:fix      # 自動修正
docker-compose exec web npm run format        # フォーマット

# バックエンド（RuboCop）
docker-compose exec web bundle exec rubocop            # チェックのみ
docker-compose exec web bundle exec rubocop --autocorrect  # 自動修正

# TypeScriptチェック
docker-compose exec web npm run typecheck
```

### テスト実行

```bash
# Railsテスト
docker-compose exec web bin/rails test

# RSpecテスト（将来追加予定）
docker-compose exec web bundle exec rspec
```

### 開発用ユーザーアカウント

シードデータで以下のテストアカウントが作成されます：

| 役割 | メールアドレス | パスワード | 権限 |
|------|---------------|-----------|------|
| 学生ユーザー | student@example.com | password123 | アルバイト |
| 部署管理者 | department.manager@example.com | password123 | 部署担当者 |
| 労務担当者 | hr.manager@example.com | password123 | 労務担当者 |
| システム管理者 | system.admin@example.com | password123 | システム管理者 |
| 承認待ちユーザー | pending.user@example.com | password123 | 承認待ち |

**ログインURL**: http://localhost:3000/users/sign_in

### その他のコマンド

```bash
# ログ確認
docker-compose logs -f web

# コンテナシェルアクセス
docker-compose exec web bash

# 環境停止
docker-compose down

# 環境完全削除（ボリューム含む）
docker-compose down -v
```
