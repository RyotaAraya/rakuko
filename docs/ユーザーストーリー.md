# ユーザーストーリー・ユースケース

## ペルソナ設定

### 👨‍🎓 学生アルバイト：田中太郎（20歳、大学2年生）
- **背景**：週3日、計20時間のアルバイト
- **掛け持ち**：コンビニバイトも週2日（16時間）
- **課題**：時間管理が苦手、制限を超えがち
- **デバイス**：主にスマートフォンを使用
- **ITスキル**：基本的なアプリ操作は可能

### 👩‍💼 部署担当者：佐藤花子（35歳、課長）
- **背景**：15名のアルバイト管理を担当
- **課題**：手作業での確認に週5時間を費やしている
- **目標**：効率化により他業務に時間を割きたい
- **デバイス**：主にPC、外出時はタブレット
- **ITスキル**：Excel・業務システムに慣れている

### 👨‍💻 労務担当者：山田次郎（45歳、人事部）
- **背景**：全社の労務管理を統括
- **課題**：法的リスクの監視に神経を使う
- **目標**：コンプライアンス遵守の自動化
- **デバイス**：PC中心
- **ITスキル**：高い（システム設定も対応可能）

## 学生アルバイト向けユーザーストーリー

### シフト希望提出
**ストーリー**：学生として、シフト希望を簡単に提出し、制限を超えないように確認したい

**詳細ユースケース**：
1. **シフト希望入力**
   - 田中は月曜日にシフト希望を入力する
   - カレンダーで各日をクリックすると時間入力フォームが表示
   - 開始時間コンボボックス（デフォルト9:00、30分刻み選択可）で「9:00」を選択
   - 終了時間コンボボックス（デフォルト18:00、30分刻み選択可）で「14:00」を選択
   - リアルタイムで「5時間勤務 → 実労働5時間」と表示
   - 月・水・金に同様に設定：各日実労働5時間
   - 週合計で「週15時間実労働」と表示

2. **掛け持ちバイト情報入力**
   - 「他のバイト時間」欄に「16時間」と入力
   - システムが「合計31時間/40時間」と表示
   - 制限内なので緑色で「OK」表示

3. **実労働時間の自動計算例**
   - 田中が「月：9:00-16:00（7時間）、水：9:00-16:00（7時間）、金：9:00-16:00（7時間）」と入力
   - システムが6時間以上勤務は自動で1時間休憩を差し引き
   - 実労働時間：各日6時間 × 3日 = 18時間と計算・表示
   - 「週18時間実労働 ✓」と緑色で表示

4. **制限違反時の対応**
   - もし田中が「月：9:00-17:00（8時間）、水：9:00-17:00（8時間）、金：9:00-16:00（7時間）、土：9:00-11:00（2時間）」と入力
   - システム計算：7時間 + 7時間 + 6時間 + 2時間 = 22時間実労働（各6時間以上勤務日は1時間休憩を自動差し引き）
   - 「週22時間実労働 ⚠️制限超過」と赤色で警告
   - 提出ボタンが無効化され、修正を促すメッセージ表示

**受け入れ条件**：
- [ ] 月間カレンダーで日付をクリックして時間入力
- [ ] 開始時間コンボボックス（デフォルト9:00、30分刻み選択可）
- [ ] 終了時間コンボボックス（デフォルト18:00、30分刻み選択可）
- [ ] コンボボックスは選択式と直接入力の両方対応
- [ ] 時間選択でリアルタイムに勤務時間と実労働時間が表示
- [ ] 6時間以上勤務時は自動で1時間休憩を差し引いて実労働時間を計算
- [ ] リアルタイムで週合計実労働時間計算が表示される
- [ ] 制限超過時は視覚的に分かりやすく警告
- [ ] 制限超過時は提出できない

### 勤怠登録
**ストーリー**：学生として、出退勤を正確に記録し、休憩時間も適切に管理したい

**詳細ユースケース**：
1. **出勤登録**
   - 田中が9:00に出勤時、アプリで「出勤」ボタンをタップ
   - 現在時刻（9:00）が自動入力される
   - 手動で時刻修正も可能

2. **休憩登録**
   - 12:00に「休憩開始」ボタンをタップ
   - 12:30に「休憩終了」ボタンをタップ
   - 休憩時間「30分」が自動記録される
   - 複数回の休憩が可能：15:00に再度「休憩開始」→15:15に「休憩終了」
   - 累計休憩時間「45分」と表示

3. **退勤登録**
   - 17:00に「退勤」ボタンをタップ
   - 実労働時間「7時間15分」と自動計算表示（出勤8時間 - 休憩45分）
   - 休憩記録がない場合は手動入力も可能

4. **時間修正・事前連絡対応**
   - 予定より早く出勤・遅く退勤する場合も時刻修正可能
   - 事前連絡があれば予定時間との差異はOK
   - システムは実労働時間のみを厳密にチェック

5. **週労働時間予測・警告**
   - 実績労働時間と残りシフト予定から週合計を予測
   - 勤務中も「現在の勤務が7時間になると週20.5時間で制限超過予定」と警告
   - 今週の状況：実績18時間 + 残り予定6時間 = 予測24時間 ❌
   - 「制限超過予定！早めに退勤してください」とアラート表示

6. **週累計確認**
   - 今週の累計実労働時間「19時間/20時間」と表示
   - 残り予定時間との合計で制限チェック
   - 残り可能な実労働時間「1時間」と明示

**受け入れ条件**：
- [ ] ワンタップで出退勤・休憩開始/終了登録できる
- [ ] 出勤・退勤時刻は手動修正可能（事前連絡あれば差異OK）
- [ ] 休憩は開始/終了ボタンで複数回記録可能
- [ ] 休憩記録がない場合は手動入力も可能
- [ ] 実労働時間が自動計算される（出勤〜退勤時間から累計休憩時間を除く）
- [ ] 実績+残り予定で週労働時間を予測し、超過予定時は事前警告
- [ ] 勤務中もリアルタイムで制限超過予測を表示
- [ ] 週20時間の制限は実労働時間ベースで厳密チェック

### 申請機能
**ストーリー**：学生として、欠勤や遅刻などの申請を簡単に行い、承認状況を確認したい

**詳細ユースケース**：
1. **欠勤申請**
   - 田中が体調不良で3月15日を欠勤したい
   - 「欠勤申請」を選択し、日付と理由を入力
   - 「体調不良のため」と理由を記載
   - 申請後、管理者に自動通知

2. **申請状況確認**
   - 申請一覧で「承認待ち」「承認済み」「差し戻し」を確認
   - 差し戻し時は理由も表示される

**受け入れ条件**：
- [ ] 申請種別ごとに適切な入力フォーム
- [ ] 申請後の状況がリアルタイム確認可能
- [ ] 差し戻し理由が明確に表示

## 部署担当者向けユーザーストーリー

### シフト承認
**ストーリー**：管理者として、学生のシフト希望を効率的に確認し、制限違反を未然に防ぎたい

**詳細ユースケース**：
1. **シフト一覧確認**
   - 佐藤は月曜日に15名分のシフト希望を確認
   - 一覧で各学生の週時間と制限チェック結果を表示
   - 「田中：15時間 ✓」「鈴木：22時間 ❌」のように色分け表示

2. **制限違反者の詳細確認**
   - 鈴木の「22時間 ❌」をクリック
   - 詳細画面で時間内訳と掛け持ちバイト情報を確認
   - 「本バイト：22時間 + 掛け持ち：20時間 = 42時間（制限超過）」

3. **差し戻し処理**
   - 「シフト時間を調整してください」とコメント付きで差し戻し
   - 鈴木に自動通知される

**受け入れ条件**：
- [ ] 一覧で制限チェック結果が一目で分かる
- [ ] 違反者の詳細が素早く確認できる
- [ ] コメント付きで差し戻しできる

### 勤怠承認
**ストーリー**：管理者として、学生の勤怠を効率的に承認し、異常を検知したい

**詳細ユースケース**：
1. **勤怠一覧確認**
   - 毎日17:30に承認作業を実施
   - 「田中：8時間（休憩1時間）✓」「佐藤：6時間（休憩なし）⚠️」
   - 異常検知がある場合は警告表示

2. **PCログ照合**
   - 田中の勤怠詳細で「PCログ：8:55-17:05」と表示
   - 申請内容と5分以内の誤差なので「整合性OK」

3. **一括承認**
   - 問題ない勤怠は一括承認機能で効率化
   - 異常がある場合のみ個別確認

**受け入れ条件**：
- [ ] 異常検知が自動で行われる
- [ ] PCログとの照合結果が表示される
- [ ] 一括承認機能で効率化

## 労務担当者向けユーザーストーリー

### 制約違反監視
**ストーリー**：労務担当者として、全社の制約違反を監視し、法的リスクを防ぎたい

**詳細ユースケース**：
1. **週次レポート確認**
   - 山田は毎週月曜日に制約違反レポートを確認
   - 「週20時間超過者：3名」「掛け持ち40時間超過者：1名」
   - 違反者リストと詳細が一覧表示

2. **リスクアラート**
   - 重大な違反（連続違反、大幅超過）は即座にアラート
   - 管理者への指導依頼メールを自動送信

**受け入れ条件**：
- [ ] 制約違反者が自動集計される
- [ ] 重大違反時は即座にアラート
- [ ] 管理者への指導依頼が自動化

### 交通費最終承認
**ストーリー**：労務担当者として、交通費申請を適切に確認し、最終承認したい

**詳細ユースケース**：
1. **申請内容確認**
   - 部署承認済みの交通費申請を確認
   - 経路の妥当性と金額の適正性をチェック
   - 高額申請（月5000円超）は特に注意深く確認

2. **最終承認・支払い処理**
   - 問題なければ最終承認し、会計システム連携

**受け入れ条件**：
- [ ] 部署承認済み案件のみ表示される
- [ ] 経路と金額の妥当性が確認できる
- [ ] 会計システム連携が準備される

## ユースケース図

```
👨‍🎓 学生アルバイト
├── シフト希望提出
├── 勤怠登録（出退勤）
├── 各種申請（欠勤・遅刻・早退・交通費）
└── 申請状況確認

👩‍💼 部署担当者
├── シフト承認・差し戻し
├── 勤怠承認・差し戻し
├── 申請承認・差し戻し（交通費以外）
└── 制約違反チェック

👨‍💻 労務担当者
├── 制約違反監視
├── 交通費最終承認
├── 全社レポート確認
└── システム設定
```